(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["appCfgAdmin"],{"4bb3":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("div",{staticClass:"crumbs"},[l("el-breadcrumb",{attrs:{separator:"/"}},[l("el-breadcrumb-item",[l("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 基础表格\n            ")])],1)],1),l("div",{staticClass:"container"},[l("div",{staticClass:"handle-box"},[l("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addNewTable}},[e._v("新建远程配置")]),l("el-autocomplete",{staticClass:"inline-input handle-input mr10",attrs:{"fetch-suggestions":e.querySearch,placeholder:"输入BundleID"},on:{select:e.handleSelect},model:{value:e.query.bid,callback:function(t){e.$set(e.query,"bid",t)},expression:"query.bid"}}),l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),l("el-table",{staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{prop:"bid",label:"bundleID"}}),l("el-table-column",{attrs:{label:"数据信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-table",{staticClass:"innerTable",attrs:{border:"",data:t.row.row.values,"show-header":!1,"max-height":"300","header-cell-class-name":"table-header"}},[l("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.type.desc))])]}}],null,!0)}),l("el-table-column",{attrs:{label:"字段名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.type.fieldName))])]}}],null,!0)}),l("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.type.type))])]}}],null,!0)}),l("el-table-column",{attrs:{prop:"value",label:"值",align:"center"}})],1)]}}])}),l("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(l){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),l("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(l){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),l("div",{staticClass:"pagination"},[l("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1),l("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"SDK配置",visible:e.editVisible,fullscreen:""},on:{"update:visible":function(t){e.editVisible=t}}},[l("el-form",{attrs:{model:e.editForm,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"BundleID",required:""}},[l("el-input",{staticClass:"inline-input handle-input",model:{value:e.editForm.bid,callback:function(t){e.$set(e.editForm,"bid",t)},expression:"editForm.bid"}})],1),l("el-form-item",{attrs:{label:"表结构",required:""}},[l("el-select",{staticClass:"mr10",attrs:{filterable:"",placeholder:"请选择表结构"},on:{change:e.onSelectTableChanged},model:{value:e.editForm.table_id,callback:function(t){e.$set(e.editForm,"table_id",t)},expression:"editForm.table_id"}},e._l(e.tableList,(function(e){return l("el-option",{key:e.tableName,attrs:{label:e.tableName,value:e.id}})})),1),l("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addNewField}},[e._v("添加字段")])],1)],1),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],staticClass:"table",attrs:{data:e.editForm.row.values,border:"","header-cell-class-name":"table-header"}},[l("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.type.desc))])]}}])}),l("el-table-column",{attrs:{label:"字段名",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("p",[e._v(e._s(t.row.type.fieldName))])]}}])}),l("el-table-column",{attrs:{label:"类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("p",[e._v(e._s(t.row.type.type))])]}}])}),l("el-table-column",{attrs:{label:"值",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.row.value,callback:function(l){e.$set(t.row,"value",l)},expression:"scope.row.value"}})]}}])}),l("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.type.required?e._e():l("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(l){return e.handleDeleteValue(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("应 用")])],1),l("el-dialog",{attrs:{width:"80%",title:"选择字段",visible:e.selectFieldVisible,"append-to-body":""},on:{"update:visible":function(t){e.selectFieldVisible=t}}},[l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoading,expression:"editLoading"}],staticClass:"table",attrs:{data:e.filterUnusedField(),border:"","max-height":"500px","header-cell-class-name":"table-header"}},[l("el-table-column",{attrs:{prop:"fieldName",label:"字段名",align:"center"}}),l("el-table-column",{attrs:{prop:"type",label:"类型",align:"center"}}),l("el-table-column",{attrs:{prop:"desc",label:"描述",align:"center"}}),l("el-table-column",{attrs:{label:"选择",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(l){return e.handleAddField(t.$index,t.row)}}},[e._v("选择")])]}}])})],1)],1)],1)],1)},n=[],i=(l("ac4d"),l("8a81"),l("5df3"),l("1c4c"),l("6b54"),l("7f7f"),l("ac6a"),l("365c"));function r(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=o(e))){var t=0,l=function(){};return{s:l,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n,i=!0,r=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){r=!0,n=e},f:function(){try{i||null==a.return||a.return()}finally{if(r)throw n}}}}function o(e,t){if(e){if("string"===typeof e)return s(e,t);var l=Object.prototype.toString.call(e).slice(8,-1);return"Object"===l&&e.constructor&&(l=e.constructor.name),"Map"===l||"Set"===l?Array.from(e):"Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var l=0,a=new Array(t);l<t;l++)a[l]=e[l];return a}var c={name:"SDKManager",data:function(){return{tableList:[],queryList:[],editLoading:!1,selectFieldVisible:!1,query:{bid:"",pageIndex:1,pageSize:10},tableData:[],multipleSelection:[],multipleFieldSelection:[],delList:[],editVisible:!1,pageTotal:0,allFields:[],editForm:{bid:"",row:{values:[]},table_id:""},idx:-1,id:-1}},created:function(){this.getData(),this.getAllTableNames()},methods:{onSelectTableChanged:function(e){var t=this;this.searchFields().then((function(){t.editForm.row.values.splice(0);var e,l=r(t.allFields);try{for(l.s();!(e=l.n()).done;){var a=e.value;a.required&&t.editForm.row.values.push({type:a,value:""})}}catch(n){l.e(n)}finally{l.f()}}))},searchFields:function(){var e=this;return this.allFields=[],this.editLoading=!0,i["c"].getTableDetail({id:this.editForm.table_id}).then((function(t){e.editLoading=!1,e.allFields=t.fields}))},getAllTableNames:function(){var e=this;i["c"].getTableNameList().then((function(t){e.tableList=t}))},handleSelect:function(e){this.query.tableName=e.tableName},createFilter:function(e){return function(t){return t.tableName.toLowerCase().indexOf(e.toLowerCase())>=0}},querySearch:function(e,t){var l=this;i["b"].getbidList().then((function(a){l.queryList.splice(0);var n,i=r(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;l.queryList.push({value:o.bid,bid:o.bid})}}catch(d){i.e(d)}finally{i.f()}var s=l.queryList,c=e?s.filter(l.createFilter(e)):s;t(c)}))},handleDeleteValue:function(e,t){this.editForm.row.values.splice(e,1)},filterUnusedField:function(){var e=this;return this.allFields.filter((function(t){var l,a=r(e.editForm.row.values);try{for(a.s();!(l=a.n()).done;){var n=l.value;if(n.type.id==t.id)return!1}}catch(i){a.e(i)}finally{a.f()}return!0}))},handleAddField:function(e,t){this.editForm.row.values.push({type:t,value:""})},addNewTable:function(){this.editVisible=!0,this.editForm={bid:"",row:{values:[]},table_id:""}},getData:function(){var e=this;i["b"].queryIPAConfig(this.query).then((function(t){e.tableData=t.rows,e.pageTotal=t.count||50}))},handleSelectionFieldChange:function(e){this.multipleFieldSelection=e},handleSearch:function(){this.$set(this.query,"pageIndex",1),this.getData()},handleDelete:function(e,t){var l=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){i["b"].removeIPAConfig({id:t.id}).then((function(){l.$message.success("删除成功"),l.tableData.splice(e,1)})).catch((function(e){l.$message.error(e||"删除失败")}))})).catch((function(){}))},addNewField:function(){this.allFields.length>0&&(this.selectFieldVisible=!0)},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){var e=this.multipleSelection.length,t="";this.delList=this.delList.concat(this.multipleSelection);for(var l=0;l<e;l++)t+=this.multipleSelection[l].name+" ";this.$message.error("删除了".concat(t)),this.multipleSelection=[]},handleEdit:function(e,t){this.idx=e;var l=JSON.parse(JSON.stringify(t));console.log(l),this.editForm=l,this.searchFields(),this.editVisible=!0},saveEdit:function(){var e=this;this.$confirm("确定要应用修改吗？","提示",{type:"warning"}).then((function(){e.editVisible=!1;e.tableData[e.idx];var t=JSON.parse(JSON.stringify(e.editForm)),l=e.$loading({fullscreen:!0});i["b"].createCfg({id:t.id,bid:t.bid,row:t.row,table_id:t.table_id}).then((function(){l.close(),e.$message.success("修改成功"),e.getData()})).catch((function(t){l.close(),e.$message.error(t||"修改失败")}))})).catch((function(){}))},handlePageChange:function(e){this.$set(this.query,"pageIndex",e),this.getData()}}},d=c,u=(l("d908"),l("2877")),b=Object(u["a"])(d,a,n,!1,null,"d1adda80",null);t["default"]=b.exports},"8eec":function(e,t,l){},d908:function(e,t,l){"use strict";var a=l("8eec"),n=l.n(a);n.a}}]);